;====================================================================
; Main.asm file generated by New Project wizard
;
; Created:   Sun Nov 20 2016
; Processor: ATmega16
; Compiler:  AVRASM (Proteus)
;====================================================================

;====================================================================
; DEFINITIONS
;====================================================================

;====================================================================
; VARIABLES
;====================================================================

;====================================================================
; RESET and INTERRUPT VECTORS
;====================================================================

      ; Reset Vector
      rjmp  Start

;====================================================================
; CODE SEGMENT
;====================================================================
.def count=r20
.org 0x00
	jmp rst_isr
.org 0x04
	jmp ext_int0_isr

ext_int0_isr:
	cli
	inc count
	ldi r21, 0x01
	and r21, count
	brne on
	cbi 0x12,5
	rjmp end
on:
	sbi 0x12,5
end:
	sei
	ret
	
rst_isr:
	CLI
	ldi r16, (0 << PD3)
	out DDRD, r16
	ldi r16, (1 << PD3)
	out PIND, r16
	ldi r16, (1 << INT1) //enable INT1
	out GICR, r16
	ldi r16, (1 << PD5) 
	out DDRD, r16
	sei
	

start:
	
	jmp start



;====================================================================
